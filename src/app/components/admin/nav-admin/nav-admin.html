<div class="relative text-text-main dark:text-background-light">
  @if (sidebarOpen) {
    <div
      class="fixed inset-0 z-40 bg-black/30 transition-opacity duration-300 md:hidden"
      aria-hidden="true"
      (click)="closeSidebar()"
    ></div>
  }

  <div
    class="md:hidden sticky top-0 z-30 flex h-16 items-center justify-between border-b border-primary-light bg-background-light px-4 py-3 shadow-sm dark:border-primary/20 dark:bg-background-dark"
  >
    <div class="flex items-center gap-3">
      <div
        class="flex size-10 items-center justify-center rounded-full bg-primary/10 text-primary dark:bg-primary/20"
      >
        <svg class="size-6" fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
          <path
            d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z"
            fill="currentColor"
          ></path>
        </svg>
      </div>
      <div class="leading-tight">
        <p class="text-xs uppercase tracking-[0.08em] text-text-muted dark:text-background-light/70">Admin</p>
        <p class="text-lg font-semibold dark:text-background-light">Miam DV</p>
      </div>
    </div>
    <div class="flex items-center gap-2">
      <button
        type="button"
        class="inline-flex items-center justify-center rounded-full border border-primary-light bg-primary-light/70 p-2 text-sm font-medium transition hover:bg-primary-light/90 dark:border-primary/30 dark:bg-primary/20 dark:hover:bg-primary/30"
        aria-label="Basculer le thème"
        (click)="toggleTheme()"
      >
        <span class="material-symbols-outlined text-lg">
          {{ theme === 'dark' ? 'light_mode' : 'dark_mode' }}
        </span>
      </button>
      <button
        type="button"
        class="inline-flex items-center justify-center rounded-full border border-primary-light bg-primary-light/70 p-2 text-sm font-medium transition hover:bg-primary-light/90 dark:border-primary/30 dark:bg-primary/20 dark:hover:bg-primary/30"
        aria-label="Ouvrir le menu"
        (click)="toggleSidebar(true)"
      >
        <span class="material-symbols-outlined">menu</span>
      </button>
    </div>
  </div>

  <aside
    aria-label="Navigation administrateur"
    class="fixed inset-y-0 left-0 z-50 flex w-72 flex-col border-r border-primary-light bg-background-light shadow-lg transition-transform duration-300 ease-in-out -translate-x-full md:static md:h-full md:translate-x-0 md:shadow-none dark:border-primary/20 dark:bg-background-dark"
    [class.translate-x-0]="sidebarOpen"
  >
    <div class="flex h-16 items-center justify-between gap-4 border-b border-primary-light px-6 dark:border-primary/20">
      <div class="flex items-center gap-3">
        <div class="size-6 text-primary">
          <svg fill="none" viewBox="0 0 48 48" xmlns="http://www.w3.org/2000/svg">
            <path
              d="M36.7273 44C33.9891 44 31.6043 39.8386 30.3636 33.69C29.123 39.8386 26.7382 44 24 44C21.2618 44 18.877 39.8386 17.6364 33.69C16.3957 39.8386 14.0109 44 11.2727 44C7.25611 44 4 35.0457 4 24C4 12.9543 7.25611 4 11.2727 4C14.0109 4 16.3957 8.16144 17.6364 14.31C18.877 8.16144 21.2618 4 24 4C26.7382 4 29.123 8.16144 30.3636 14.31C31.6043 8.16144 33.9891 4 36.7273 4C40.7439 4 44 12.9543 44 24C44 35.0457 40.7439 44 36.7273 44Z"
              fill="currentColor"
            ></path>
          </svg>
        </div>
        <div class="leading-tight">
          <p class="text-xs uppercase tracking-[0.08em] text-text-muted dark:text-primary/80">Admin</p>
          <p class="text-lg font-bold">Miam DV</p>
        </div>
      </div>
      <button
        type="button"
        class="md:hidden rounded-full p-2 text-text-main transition hover:bg-primary-light dark:text-background-light dark:hover:bg-primary/20"
        aria-label="Fermer le menu"
        (click)="closeSidebar()"
      >
        <span class="material-symbols-outlined">close</span>
      </button>
    </div>

    <nav class="flex-1 overflow-y-auto px-4 py-6">
      <ul class="space-y-2">
        @for (link of links; track link.label) {
          <li>
            <a
              [routerLink]="link.commands"
              routerLinkActive="bg-primary-light text-primary font-semibold dark:bg-primary/30 dark:text-white"
              [routerLinkActiveOptions]="{ exact: true }"
              class="flex items-center gap-3 rounded-lg px-3 py-2 text-base font-medium text-text-main transition-colors hover:bg-primary-light/80 hover:text-primary dark:text-background-light/75 dark:hover:bg-primary/20 dark:hover:text-white"
              (click)="closeSidebar()"
              #rla="routerLinkActive"
            >
              <span
                class="material-symbols-outlined text-lg transition-colors"
                [class.text-primary]="rla.isActive && theme === 'light'"
                [class.text-white]="rla.isActive && theme === 'dark'"
              >
                {{ link.icon }}
              </span>
              <span>{{ link.label }}</span>
            </a>
          </li>
        }
      </ul>
    </nav>

    <div class="border-t border-primary-light px-4 py-4 dark:border-primary/20 md:px-6">
      <button
        type="button"
        class="flex w-full items-center justify-center gap-2 rounded-full border border-primary/50 bg-primary-light/70 px-4 py-2 text-sm font-medium text-text-main transition hover:bg-primary-light/90 dark:border-primary/30 dark:bg-primary/20 dark:text-background-light dark:hover:bg-primary/30"
        aria-label="Basculer le thème"
        (click)="toggleTheme()"
      >
        <span class="material-symbols-outlined text-lg">
          {{ theme === 'dark' ? 'light_mode' : 'dark_mode' }}
        </span>
        <span class="hidden sm:inline">
          {{ theme === 'dark' ? 'Mode clair' : 'Mode sombre' }}
        </span>
      </button>
    </div>
  </aside>
</div>
